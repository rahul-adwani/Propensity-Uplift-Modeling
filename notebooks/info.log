[2021-05-24 12:20:22,319|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 12:20:22,331|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 12:20:22,335|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:20:22,336|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:20:22,338|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 12:20:22,349|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 12:20:22,351|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:20:22,353|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 12:20:22,423|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 12:20:22,549|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:20:22,551|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 12:20:22,553|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:20:22,554|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:20:22,557|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:20:22,568|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 12:20:22,719|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 12:20:22,720|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 12:20:26,523|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 12:20:26,525|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 12:20:26,551|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:20:26,553|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:20:26,559|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:20:26,584|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 12:20:26,612|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 12:20:27,112|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 12:20:27,165|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 12:20:27,183|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 12:20:27,208|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:20:27,209|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:20:27,212|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.50625
[2021-05-24 12:20:27,213|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.505
[2021-05-24 12:42:23,160|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 12:42:23,184|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 12:42:23,186|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 12:42:28,940|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 12:42:28,944|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 12:42:29,005|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-24 12:42:29,039|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:42:29,047|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 12:42:29,049|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 12:42:31,511|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 12:42:31,513|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 12:42:31,565|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-24 12:42:31,602|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:42:31,626|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2021-05-24 12:42:31,633|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:42:31,635|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:42:31,656|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2021-05-24 12:42:31,679|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2021-05-24 12:42:31,698|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 12:42:31,716|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2021-05-24 12:42:31,754|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 12:42:31,757|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:42:31,763|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2021-05-24 12:42:31,789|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2021-05-24 12:42:31,794|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:42:31,797|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:42:31,802|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2021-05-24 12:42:31,836|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01,treated__proba,untreated__proba]) -> [df_02]
[2021-05-24 12:42:31,858|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:42:31,860|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:43:16,366|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2021-05-24 12:43:16,388|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2021-05-24 12:43:16,494|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:43:16,495|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:43:16,556|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2021-05-24 12:43:16,613|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2021-05-24 12:43:16,706|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 1.0:
[2021-05-24 12:43:16,752|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 1.0:
[2021-05-24 12:43:16,771|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 12:43:16,803|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2021-05-24 12:43:16,904|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 0.0:
[2021-05-24 12:43:16,943|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 0.0:
[2021-05-24 12:43:16,960|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 12:43:16,962|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:43:16,995|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2021-05-24 12:43:17,024|kedro.pipeline.node|INFO] Running node: estimate_effect([args,treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2021-05-24 12:43:17,037|causallift.nodes.utils|INFO] 
## Overall simulated effect of recommendation based on the uplift modeling:
[2021-05-24 12:43:17,061|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:43:17,064|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:33,244|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:33,275|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 12:53:33,284|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:33,284|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:33,289|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:33,312|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 12:53:33,339|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 12:53:33,360|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:53:33,361|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 12:53:33,368|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:53:33,370|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 12:53:33,374|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:53:33,375|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:33,379|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:33,399|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 12:53:37,937|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:37,938|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:37,953|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:37,970|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 12:53:38,007|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:38,009|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:58,944|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:58,967|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 12:53:58,977|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:58,979|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:58,984|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:58,999|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 12:53:59,017|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:53:59,022|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 12:53:59,025|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:53:59,028|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 12:53:59,029|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:53:59,032|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:59,036|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:59,052|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 12:53:59,219|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:59,224|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:53:59,239|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:53:59,257|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 12:53:59,281|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:53:59,284|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:54:17,194|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 12:54:17,215|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 12:54:17,221|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:54:17,224|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:54:17,227|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 12:54:17,240|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 12:54:17,253|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:54:17,255|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 12:54:17,257|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:54:17,260|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 12:54:17,262|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:54:17,263|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:54:17,266|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:54:17,282|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 12:54:17,289|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 12:54:17,433|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 12:54:17,455|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:54:17,456|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:54:17,464|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:54:17,478|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 12:54:17,495|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:54:17,497|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:59:31,470|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 12:59:31,491|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 12:59:31,496|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:59:31,498|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:59:31,501|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 12:59:31,514|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 12:59:31,537|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 12:59:31,542|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 12:59:31,547|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 12:59:31,553|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 12:59:31,556|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 12:59:31,558|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:59:31,563|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:59:31,576|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 12:59:31,582|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 12:59:31,583|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 12:59:34,511|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 12:59:34,513|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 12:59:34,551|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:59:34,554|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:59:34,570|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 12:59:34,603|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 12:59:34,624|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 12:59:35,027|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 12:59:35,076|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 12:59:35,085|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 12:59:35,103|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 12:59:35,104|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 12:59:35,106|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.515
[2021-05-24 12:59:35,107|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.515
[2021-05-24 15:59:53,306|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 15:59:53,316|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 15:59:53,319|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 15:59:53,320|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 15:59:53,321|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 15:59:53,332|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 15:59:53,344|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 15:59:53,354|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 15:59:53,355|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 15:59:53,356|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 15:59:53,358|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 15:59:53,360|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 15:59:53,360|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 15:59:53,362|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 15:59:53,370|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 15:59:53,410|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 15:59:53,411|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 15:59:56,546|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 15:59:56,548|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 15:59:56,564|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 15:59:56,565|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 15:59:56,576|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 15:59:56,585|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 15:59:56,593|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 15:59:56,736|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 15:59:56,755|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 15:59:56,761|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 15:59:56,773|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 15:59:56,774|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 15:59:56,776|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.5025
[2021-05-24 15:59:56,777|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.5
[2021-05-24 15:59:56,790|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 15:59:56,803|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 15:59:56,804|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 15:59:58,544|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 15:59:58,546|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 15:59:58,579|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-24 15:59:58,599|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 15:59:58,602|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 15:59:58,604|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 15:59:59,361|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
[2021-05-24 15:59:59,363|kedro.runner.sequential_runner|WARNING] There are 2 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:
  --from-nodes "model_for_treated_fit([args,df_01]) -> [treated__model_dict],bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]"
[2021-05-24 16:00:22,600|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 16:00:22,607|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 16:00:22,610|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:00:22,612|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:00:22,613|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 16:00:22,622|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 16:00:22,631|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:00:22,632|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 16:00:22,633|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 16:00:22,635|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 16:00:22,637|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 16:00:22,638|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:00:22,640|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:00:22,648|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 16:00:22,651|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 16:00:22,652|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 16:00:25,149|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 16:00:25,151|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 16:00:25,174|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:00:25,175|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:00:25,186|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:00:25,194|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 16:00:25,203|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 16:00:25,341|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 16:00:25,359|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 16:00:25,364|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 16:00:25,374|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:00:25,375|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:00:25,377|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.50125
[2021-05-24 16:00:25,378|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.5
[2021-05-24 16:00:25,402|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 16:00:25,410|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 16:00:25,410|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 16:00:26,359|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 16:00:26,361|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 16:00:26,393|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-24 16:00:26,412|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:00:26,415|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 16:00:26,417|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 16:00:27,202|kedro.pipeline.node|ERROR] Node `model_for_treated_fit([args,df_01]) -> [treated__model_dict]` failed with error: 
A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
[2021-05-24 16:00:27,204|kedro.runner.sequential_runner|WARNING] There are 2 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:
  --from-nodes "model_for_treated_fit([args,df_01]) -> [treated__model_dict],bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]"
[2021-05-24 16:02:36,126|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 16:02:36,134|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 16:02:36,140|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:02:36,142|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:02:36,144|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 16:02:36,156|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 16:02:36,158|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:02:36,161|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 16:02:36,174|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 16:02:36,184|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 16:02:36,186|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 16:02:36,187|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 16:02:36,188|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:02:36,190|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:02:36,198|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 16:02:36,237|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 16:02:36,238|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 16:02:38,956|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 16:02:38,957|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 16:02:38,973|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:02:38,975|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:02:38,985|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:02:38,993|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 16:02:39,000|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 16:02:39,144|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 16:02:39,165|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 16:02:39,170|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 16:02:39,182|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:02:39,183|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:02:39,184|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.51
[2021-05-24 16:02:39,185|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.51
[2021-05-24 16:02:39,200|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 16:02:39,209|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 16:02:39,211|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 16:02:40,779|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 16:02:40,780|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 16:02:40,813|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-24 16:02:40,834|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:02:40,841|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 16:02:40,842|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 16:02:41,540|kedro.pipeline.node|ERROR] Node `model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]` failed with error: 
A task has failed to un-serialize. Please ensure that the arguments of the function are all picklable.
[2021-05-24 16:02:41,543|kedro.runner.sequential_runner|WARNING] There are 2 nodes that have not run.
You can resume the pipeline run by adding the following argument to your previous command:
  --from-nodes "model_for_untreated_fit([args,df_01]) -> [untreated__model_dict],bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]"
[2021-05-24 16:05:37,633|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:37,647|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 16:05:37,650|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:37,651|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:37,652|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:37,660|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 16:05:37,672|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 16:05:37,684|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:05:37,685|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 16:05:37,686|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 16:05:37,688|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 16:05:37,689|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 16:05:37,690|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:37,692|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:37,699|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 16:05:37,740|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 16:05:37,741|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 16:05:40,337|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 16:05:40,338|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 16:05:40,355|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:40,356|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:40,366|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:40,374|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 16:05:40,381|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 16:05:40,527|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 16:05:40,546|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 16:05:40,551|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 16:05:40,562|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:40,563|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:40,565|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.4775
[2021-05-24 16:05:40,566|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.475
[2021-05-24 16:05:40,581|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:40,598|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 16:05:40,600|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 16:05:41,675|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 16:05:41,677|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 16:05:41,709|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-24 16:05:41,730|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 16:05:41,733|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 16:05:41,734|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 16:05:42,379|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 16:05:42,381|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 16:05:42,412|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-24 16:05:42,432|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 16:05:42,444|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2021-05-24 16:05:42,453|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 16:05:42,455|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,475|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,492|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2021-05-24 16:05:42,502|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 16:05:42,515|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2021-05-24 16:05:42,529|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 16:05:42,531|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,533|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,551|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2021-05-24 16:05:42,554|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:42,555|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,557|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,576|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01,treated__proba,untreated__proba]) -> [df_02]
[2021-05-24 16:05:42,591|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:42,593|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,678|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,689|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2021-05-24 16:05:42,718|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:42,719|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,739|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,759|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2021-05-24 16:05:42,796|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 1.0:
[2021-05-24 16:05:42,821|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 1.0:
[2021-05-24 16:05:42,834|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 16:05:42,858|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2021-05-24 16:05:42,905|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 0.0:
[2021-05-24 16:05:42,930|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 0.0:
[2021-05-24 16:05:42,942|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 16:05:42,944|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 16:05:42,978|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2021-05-24 16:05:42,993|kedro.pipeline.node|INFO] Running node: estimate_effect([args,treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2021-05-24 16:05:42,998|causallift.nodes.utils|INFO] 
## Overall simulated effect of recommendation based on the uplift modeling:
[2021-05-24 16:05:43,004|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 16:05:43,005|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:27,723|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:27,753|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-24 20:33:27,763|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:27,763|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:27,772|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:27,801|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-24 20:33:27,804|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 20:33:27,807|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-24 20:33:27,921|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-24 20:33:28,057|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 20:33:28,060|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-24 20:33:28,063|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 20:33:28,064|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:28,068|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:28,086|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-24 20:33:28,192|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-24 20:33:28,192|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-24 20:33:32,547|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-24 20:33:32,551|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-24 20:33:32,579|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:32,584|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:32,607|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:32,626|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-24 20:33:32,647|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-24 20:33:33,081|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-24 20:33:33,133|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-24 20:33:33,143|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-24 20:33:33,174|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:33,175|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:33,178|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.5225
[2021-05-24 20:33:33,179|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.52
[2021-05-24 20:33:33,211|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:33,243|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-24 20:33:33,247|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-24 20:33:35,745|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 20:33:35,748|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 20:33:35,796|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-24 20:33:35,833|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-24 20:33:35,838|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-24 20:33:35,840|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-24 20:33:37,165|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-24 20:33:37,167|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-24 20:33:37,216|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-24 20:33:37,251|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-24 20:33:37,274|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2021-05-24 20:33:37,285|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-24 20:33:37,286|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:37,306|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:37,327|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2021-05-24 20:33:37,346|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 20:33:37,366|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2021-05-24 20:33:37,392|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 20:33:37,395|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:37,402|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:37,428|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2021-05-24 20:33:37,434|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:37,437|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:37,442|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:37,477|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01,treated__proba,untreated__proba]) -> [df_02]
[2021-05-24 20:33:37,492|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:37,494|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:37,615|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:37,635|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2021-05-24 20:33:37,705|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:37,706|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:37,748|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:37,800|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2021-05-24 20:33:37,900|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 0.0:
[2021-05-24 20:33:37,943|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 0.0:
[2021-05-24 20:33:37,961|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-24 20:33:37,986|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2021-05-24 20:33:38,081|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 1.0:
[2021-05-24 20:33:38,130|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 1.0:
[2021-05-24 20:33:38,146|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-24 20:33:38,147|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-24 20:33:38,180|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2021-05-24 20:33:38,207|kedro.pipeline.node|INFO] Running node: estimate_effect([args,treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2021-05-24 20:33:38,222|causallift.nodes.utils|INFO] 
## Overall simulated effect of recommendation based on the uplift modeling:
[2021-05-24 20:33:38,240|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-24 20:33:38,242|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:30,597|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:30,605|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-25 00:54:30,610|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:30,611|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:30,612|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:30,621|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-25 00:54:30,699|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-25 00:54:30,796|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-25 00:54:30,797|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-25 00:54:30,798|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-25 00:54:30,799|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-25 00:54:30,800|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-25 00:54:30,801|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:30,803|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:30,814|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-25 00:54:30,893|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-25 00:54:30,893|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-25 00:54:34,016|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 10, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l2', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-25 00:54:34,017|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-25 00:54:34,032|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:34,034|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:34,045|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:34,054|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-25 00:54:34,062|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-25 00:54:34,230|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-25 00:54:34,250|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-25 00:54:34,255|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-25 00:54:34,270|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:34,271|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:34,273|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.505
[2021-05-25 00:54:34,273|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.505
[2021-05-25 00:54:34,293|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:34,302|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-25 00:54:34,303|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-25 00:54:35,819|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-25 00:54:35,821|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-25 00:54:35,852|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-25 00:54:35,877|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-25 00:54:35,884|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-25 00:54:35,886|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-25 00:54:36,607|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-25 00:54:36,609|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-25 00:54:36,640|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-25 00:54:36,660|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-25 00:54:36,674|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2021-05-25 00:54:36,683|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-25 00:54:36,685|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:36,710|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:36,726|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2021-05-25 00:54:36,736|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-25 00:54:36,749|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2021-05-25 00:54:36,765|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-25 00:54:36,767|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:36,769|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:36,786|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2021-05-25 00:54:36,789|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:36,790|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:36,792|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:36,813|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01,treated__proba,untreated__proba]) -> [df_02]
[2021-05-25 00:54:36,830|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:36,831|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:36,919|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:36,928|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2021-05-25 00:54:36,964|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:36,965|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:36,982|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:37,001|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2021-05-25 00:54:37,038|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 0.0:
[2021-05-25 00:54:37,064|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 0.0:
[2021-05-25 00:54:37,077|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-25 00:54:37,105|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2021-05-25 00:54:37,152|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 1.0:
[2021-05-25 00:54:37,178|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 1.0:
[2021-05-25 00:54:37,193|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-25 00:54:37,195|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:54:37,225|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2021-05-25 00:54:37,242|kedro.pipeline.node|INFO] Running node: estimate_effect([args,treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2021-05-25 00:54:37,247|causallift.nodes.utils|INFO] 
## Overall simulated effect of recommendation based on the uplift modeling:
[2021-05-25 00:54:37,253|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:54:37,254|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:27,188|causallift.context.flexible_context|INFO] Run pipeline (tags: ['011_bundle_train_and_test_data'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:27,196|kedro.pipeline.node|INFO] Running node: bundle_train_and_test_data([args_raw,test_df,train_df]) -> [df_00]
[2021-05-25 00:55:27,201|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:27,201|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:27,203|causallift.context.flexible_context|INFO] Run pipeline (tags: ['121_prepare_args', '131_treatment_fractions_', '141_initialize_model'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:27,211|kedro.pipeline.node|INFO] Running node: impute_cols_features([args_raw,df_00]) -> [args_intermediate]
[2021-05-25 00:55:27,212|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-25 00:55:27,214|kedro.pipeline.node|INFO] Running node: treatment_fractions_([args_raw,df_00]) -> [treatment_fractions]
[2021-05-25 00:55:27,225|numexpr.utils|INFO] NumExpr defaulting to 8 threads.
[2021-05-25 00:55:27,236|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-25 00:55:27,237|kedro.pipeline.node|INFO] Running node: schedule_propensity_scoring([args_intermediate,df_00]) -> [args]
[2021-05-25 00:55:27,239|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-25 00:55:27,239|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:27,241|causallift.context.flexible_context|INFO] Run pipeline (tags: ['211_fit_propensity'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:27,249|kedro.pipeline.node|INFO] Running node: fit_propensity([args,df_00]) -> [propensity_model]
[2021-05-25 00:55:27,289|causallift.nodes.estimate_propensity|INFO] ## Propensity scores will be estimated by logistic regression.
[2021-05-25 00:55:27,290|causallift.nodes.estimate_propensity|INFO] ### Parameters for grid search of Logistic regression:
{'search_cv': 'sklearn.model_selection.GridSearchCV', 'estimator': 'sklearn.linear_model.LogisticRegression', 'scoring': None, 'cv': 3, 'return_train_score': False, 'n_jobs': -1, 'param_grid': {'random_state': [0], 'C': [0.1, 1, 10], 'class_weight': [None], 'dual': [False], 'fit_intercept': [True], 'intercept_scaling': [1], 'max_iter': [100], 'multi_class': ['ovr'], 'n_jobs': [1], 'penalty': ['l1', 'l2'], 'solver': ['liblinear'], 'tol': [0.0001], 'warm_start': [False]}}
[2021-05-25 00:55:29,881|causallift.nodes.estimate_propensity|INFO] ### Best parameter for logistic regression:
{'C': 0.1, 'class_weight': None, 'dual': False, 'fit_intercept': True, 'intercept_scaling': 1, 'l1_ratio': None, 'max_iter': 100, 'multi_class': 'ovr', 'n_jobs': 1, 'penalty': 'l1', 'random_state': 0, 'solver': 'liblinear', 'tol': 0.0001, 'verbose': 0, 'warm_start': False}
[2021-05-25 00:55:29,882|causallift.nodes.estimate_propensity|INFO] 
## Coefficients of logistic regression:
[2021-05-25 00:55:29,903|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:29,905|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:29,914|causallift.context.flexible_context|INFO] Run pipeline (tags: ['221_estimate_propensity'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:29,922|kedro.pipeline.node|INFO] Running node: estimate_propensity([args,df_00,propensity_model]) -> [df_01]
[2021-05-25 00:55:29,928|causallift.nodes.estimate_propensity|INFO] 
### Histogram of propensity score for train and test data:
[2021-05-25 00:55:30,072|causallift.nodes.estimate_propensity|INFO] 
### Score Table for logistic regression to calculate propensity score:
[2021-05-25 00:55:30,091|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Train:
[2021-05-25 00:55:30,095|causallift.nodes.estimate_propensity|INFO] 
### Confusion Matrix for Test:
[2021-05-25 00:55:30,107|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:30,108|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:30,109|causallift.causal_lift|INFO] ### Treatment fraction in train dataset: 0.4975
[2021-05-25 00:55:30,110|causallift.causal_lift|INFO] ### Treatment fraction in test dataset: 0.495
[2021-05-25 00:55:30,119|causallift.context.flexible_context|INFO] Run pipeline (tags: ['311_fit', '312_bundle_2_models'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:30,133|kedro.pipeline.node|INFO] Running node: model_for_treated_fit([args,df_01]) -> [treated__model_dict]
[2021-05-25 00:55:30,134|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 1.0
[2021-05-25 00:55:31,230|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 1.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-25 00:55:31,232|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-25 00:55:31,264|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 1.0
[2021-05-25 00:55:31,285|kedro.runner.sequential_runner|INFO] Completed 1 out of 3 tasks
[2021-05-25 00:55:31,289|kedro.pipeline.node|INFO] Running node: model_for_untreated_fit([args,df_01]) -> [untreated__model_dict]
[2021-05-25 00:55:31,290|causallift.nodes.model_for_each|INFO] 

## Model for Treatment = 0.0
[2021-05-25 00:55:31,974|causallift.nodes.model_for_each|INFO] ### Best parameters of the model trained using samples with observational Treatment: 0.0 
 {'objective': 'binary:logistic', 'base_score': 0.5, 'booster': 'gbtree', 'colsample_bylevel': 1, 'colsample_bynode': 1, 'colsample_bytree': 1, 'gamma': 0, 'gpu_id': -1, 'importance_type': 'gain', 'interaction_constraints': '', 'learning_rate': 0.1, 'max_delta_step': 0, 'max_depth': 3, 'min_child_weight': 1, 'missing': None, 'monotone_constraints': '()', 'n_estimators': 100, 'n_jobs': -1, 'num_parallel_tree': 1, 'random_state': 0, 'reg_alpha': 0, 'reg_lambda': 1, 'scale_pos_weight': 1, 'subsample': 1, 'tree_method': 'exact', 'validate_parameters': 1, 'verbosity': None, 'nthread': -1, 'verbose': 0}
[2021-05-25 00:55:31,975|causallift.nodes.model_for_each|INFO] ## Feature importances not available.
[2021-05-25 00:55:32,006|causallift.nodes.model_for_each|INFO] 
### Outcome estimated by the model trained using samples with observational Treatment: 0.0
[2021-05-25 00:55:32,025|kedro.runner.sequential_runner|INFO] Completed 2 out of 3 tasks
[2021-05-25 00:55:32,039|kedro.pipeline.node|INFO] Running node: bundle_treated_and_untreated_models([treated__model_dict,untreated__model_dict]) -> [uplift_models_dict]
[2021-05-25 00:55:32,048|kedro.runner.sequential_runner|INFO] Completed 3 out of 3 tasks
[2021-05-25 00:55:32,049|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,068|causallift.context.flexible_context|INFO] Run pipeline (tags: ['321_predict_proba'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,085|kedro.pipeline.node|INFO] Running node: model_for_treated_predict_proba([args,df_01,uplift_models_dict]) -> [treated__proba]
[2021-05-25 00:55:32,096|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-25 00:55:32,107|kedro.pipeline.node|INFO] Running node: model_for_untreated_predict_proba([args,df_01,uplift_models_dict]) -> [untreated__proba]
[2021-05-25 00:55:32,122|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-25 00:55:32,124|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,126|causallift.context.flexible_context|INFO] Run pipeline (tags: ['411_compute_cate'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,146|kedro.pipeline.node|INFO] Running node: compute_cate([treated__proba,untreated__proba]) -> [cate_estimated]
[2021-05-25 00:55:32,149|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:32,150|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,153|causallift.context.flexible_context|INFO] Run pipeline (tags: ['421_add_cate_to_df'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,172|kedro.pipeline.node|INFO] Running node: add_cate_to_df([args,cate_estimated,df_01,treated__proba,untreated__proba]) -> [df_02]
[2021-05-25 00:55:32,188|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:32,190|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,274|causallift.context.flexible_context|INFO] Run pipeline (tags: ['511_recommend_by_cate'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,286|kedro.pipeline.node|INFO] Running node: recommend_by_cate([args,df_02,treatment_fractions]) -> [df_03]
[2021-05-25 00:55:32,332|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:32,333|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,375|causallift.context.flexible_context|INFO] Run pipeline (tags: ['521_simulate_recommendation'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,421|kedro.pipeline.node|INFO] Running node: model_for_treated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [treated__sim_eval_df]
[2021-05-25 00:55:32,491|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 1.0:
[2021-05-25 00:55:32,516|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 1.0:
[2021-05-25 00:55:32,531|kedro.runner.sequential_runner|INFO] Completed 1 out of 2 tasks
[2021-05-25 00:55:32,555|kedro.pipeline.node|INFO] Running node: model_for_untreated_simulate_recommendation([args,df_03,uplift_models_dict]) -> [untreated__sim_eval_df]
[2021-05-25 00:55:32,596|causallift.nodes.model_for_each|INFO] 
### Simulated outcome for samples with recommended treatment = 0.0:
[2021-05-25 00:55:32,622|causallift.nodes.model_for_each|INFO] 
### Simulated effect for samples with recommended treatment = 0.0:
[2021-05-25 00:55:32,635|kedro.runner.sequential_runner|INFO] Completed 2 out of 2 tasks
[2021-05-25 00:55:32,637|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
[2021-05-25 00:55:32,669|causallift.context.flexible_context|INFO] Run pipeline (tags: ['531_estimate_effect'], SequentialRunner, only_missing: False)
[2021-05-25 00:55:32,682|kedro.pipeline.node|INFO] Running node: estimate_effect([args,treated__sim_eval_df,untreated__sim_eval_df]) -> [estimated_effect_df]
[2021-05-25 00:55:32,687|causallift.nodes.utils|INFO] 
## Overall simulated effect of recommendation based on the uplift modeling:
[2021-05-25 00:55:32,693|kedro.runner.sequential_runner|INFO] Completed 1 out of 1 tasks
[2021-05-25 00:55:32,694|kedro.runner.sequential_runner|INFO] Pipeline execution completed successfully.
